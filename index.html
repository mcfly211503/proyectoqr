<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Generador de QR y Envío</title>
    <link rel="stylesheet" href="/static/style.css">

    <script src="/static/animations.js"></script>
</head>

<body>

    <div class="card">
        <h3>Generador de QR</h3>
        <p class="subtitle">Ingresa tus datos para generar el código</p>

        <div class="input-group">
            <label>Nombre</label>
            <input type="text" id="nombre" placeholder="Juan Pérez">
        </div>

        <div class="input-group">
            <label>Correo</label>
            <input type="email" id="correo" placeholder="hola@ejemplo.com">
        </div>

        <div class="input-group">
            <label>URL o Contenido</label>
            <input type="text" id="url_qr" placeholder="https://tu-sitio.com">
        </div>

        <button onclick="enviarDatos()">Generar y Enviar</button>
        <div id="estado"></div>
    </div>

    <script>
        async function enviarDatos() {
            const datos = {
                nombre: document.getElementById('nombre').value,
                correo: document.getElementById('correo').value,
                url_qr: document.getElementById('url_qr').value
            };

            const estado = document.getElementById('estado');
            estado.innerText = "Procesando...";
            estado.style.color = "blue";

            try {
                // Reemplaza con la URL de tu app en Render cuando la subas
                const response = await fetch("/procesar", {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(datos)
                });

                if (response.ok) {
                    estado.innerText = "¡Éxito! PDF generado y correo enviado.";
                    estado.style.color = "green";
                } else {
                    estado.innerText = "Hubo un error en el servidor.";
                    estado.style.color = "red";
                }
            } catch (error) {
                estado.innerText = "No se pudo conectar con el servidor.";
                estado.style.color = "red";
            }
        }
    </script>

</body>

</html>